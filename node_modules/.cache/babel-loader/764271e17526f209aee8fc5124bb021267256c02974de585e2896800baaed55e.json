{"ast":null,"code":"var spawn = require('child_process').spawn;\nvar Readable = require('readable-stream').Readable;\nvar Through = require('stream').PassThrough;\nvar util = require('util');\nvar JSONStream = require('JSONStream');\nvar Dataset = function (options) {\n  Readable.call(this, {\n    objectMode: true\n  });\n  this._options = options;\n  this._isSpawned = false;\n};\nutil.inherits(Dataset, Readable);\nDataset.prototype._read = function () {\n  if (this._pyError) {\n    return;\n  }\n  if (!this._isSpawned) {\n    this._spawn();\n    this._pipifyStdio();\n    this._isSpawned = true;\n    var params = JSON.stringify(this._options.params || {}) + '\\n';\n    this._pyProcess.stdin.write(params);\n  }\n};\nDataset.prototype._spawn = function () {\n  var self = this;\n  var args = ['scikit.py', '--module', self._options.module, '--method', self._options.method, '--field', self._options.field];\n  self._pyProcess = spawn('python2', args, {\n    cwd: __dirname,\n    stdio: ['pipe', 'pipe', 'pipe']\n  });\n  self._pyProcess.on('error', function (err) {\n    self._pyError = err;\n    self.emit('error', err);\n  });\n  self._pyProcess.on('exit', function (code, signal) {\n    var message;\n    if (code) {\n      var pyerr = self._pyError ? 'Python stderr:\\n' + self._pyError : '';\n      message = 'Python crashed with code ' + code + ' and signal ' + signal + '\\n' + pyerr;\n      self._pyError = new Error(message);\n      self.emit('error', self._pyError);\n    }\n  });\n};\nDataset.prototype._pipifyStdio = function () {\n  this._pipifyStderr();\n  this._pipifyStdout();\n};\nDataset.prototype._pipifyStdout = function () {\n  var self = this;\n  // TODO Read from stdout in pull fashion\n  self._pyProcess.stdout.pipe(JSONStream.parse('*')).pipe(new Through({\n    objectMode: true\n  })).on('readable', function () {\n    var item;\n    while ((item = this.read()) !== null) {\n      self.push(item);\n    }\n  }).on('end', function () {\n    self.push(null);\n  });\n};\nDataset.prototype._pipifyStderr = function () {\n  var self = this;\n  self._pyProcess.stderr.setEncoding('utf8');\n  self._pyProcess.stderr.on('data', function (data) {\n    if (/^execvp\\(\\)/.test(data)) {\n      self._pyError = new Error(' Failed to run python');\n    } else {\n      self._pyError = self._pyError || new Error();\n      self._pyError.message += data;\n    }\n  });\n};\nmodule.exports = function (options) {\n  return new Dataset(options);\n};","map":{"version":3,"names":["spawn","require","Readable","Through","PassThrough","util","JSONStream","Dataset","options","call","objectMode","_options","_isSpawned","inherits","prototype","_read","_pyError","_spawn","_pipifyStdio","params","JSON","stringify","_pyProcess","stdin","write","self","args","module","method","field","cwd","__dirname","stdio","on","err","emit","code","signal","message","pyerr","Error","_pipifyStderr","_pipifyStdout","stdout","pipe","parse","item","read","push","stderr","setEncoding","data","test","exports"],"sources":["C:/Users/Sagar/Desktop/Sensor/my-app/node_modules/scikit-learn/lib/dataset-stream.js"],"sourcesContent":["var spawn    = require('child_process').spawn;\nvar Readable = require('readable-stream').Readable;\nvar Through  = require('stream').PassThrough;\nvar util     = require('util');\n\nvar JSONStream = require('JSONStream');\n\nvar Dataset = function (options) {\n  Readable.call(this, { objectMode: true });\n  this._options = options;\n  this._isSpawned = false;\n};\nutil.inherits(Dataset, Readable);\n\nDataset.prototype._read = function () {\n  if (this._pyError) { return; }\n  if (!this._isSpawned) {\n    this._spawn();\n    this._pipifyStdio();\n    this._isSpawned = true;\n\n    var params = JSON.stringify(this._options.params || {}) + '\\n';\n    this._pyProcess.stdin.write(params);\n  }\n};\n\nDataset.prototype._spawn = function() {\n  var self = this;\n  var args = [\n    'scikit.py',\n    '--module', self._options.module,\n    '--method', self._options.method,\n    '--field',  self._options.field\n  ];\n  self._pyProcess = spawn('python2', args, {\n    cwd: __dirname,\n    stdio: ['pipe', 'pipe', 'pipe']\n  });\n  self._pyProcess.on('error', function (err) {\n    self._pyError = err;\n    self.emit('error', err);\n  });\n  self._pyProcess.on('exit', function (code, signal) {\n    var message;\n\n    if (code) {\n      var pyerr = self._pyError ? ('Python stderr:\\n' + self._pyError) : '';\n      message = 'Python crashed with code ' + code +\n        ' and signal ' + signal + '\\n' + pyerr;\n      self._pyError = new Error(message);\n      self.emit('error', self._pyError);\n    }\n  });\n};\n\nDataset.prototype._pipifyStdio = function() {\n  this._pipifyStderr();\n  this._pipifyStdout();\n};\n\nDataset.prototype._pipifyStdout = function() {\n  var self = this;\n  // TODO Read from stdout in pull fashion\n  self._pyProcess.stdout\n    .pipe(JSONStream.parse('*'))\n    .pipe(new Through({ objectMode: true }))\n    .on('readable', function () {\n      var item;\n      while ((item = this.read()) !== null) {\n        self.push(item);\n      }\n    })\n    .on('end', function () {\n      self.push(null);\n    });\n};\n\nDataset.prototype._pipifyStderr = function() {\n  var self = this;\n  self._pyProcess.stderr.setEncoding('utf8');\n  self._pyProcess.stderr.on('data', function (data) {\n    if (/^execvp\\(\\)/.test(data)) {\n      self._pyError = new Error(' Failed to run python');\n    } else {\n      self._pyError = self._pyError || new Error();\n      self._pyError.message += data;\n    }\n  });\n};\n\nmodule.exports = function (options) {\n  return new Dataset(options);\n};\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}